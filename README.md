# karpov_courses
Финальный проект из 4 этапов: endpoint, рекомендательная система постов в социальной сети, рекомендательная система с помощью Deep Learning, A/B эксперимент на сравнение двух рекомендательных систем

# 1 этап: ENDPOINT
Напишите endpoint GET /post/recommendations/, который принимает query-parameters id и limit (limit должен быть по умолчанию равным 10).

NB: в этом эндпоинте важно прописать слэш в конце, чтобы FastAPI различал эндпоинты /post/recommendations/ и /post/{id}.

Этот endpoint должен вернуть топ limit постов по количеству лайков. Более формально: необходимо подсчитать количество лайков для каждого поста, отсортировать по убыванию и выдать первые limit записей постов (их id, text и topic). Параметр id в этом задании использован не будет, он понадобится вам для сдачи финального проекта.

# 2 этап: Рекомендательная система
Представим, что мы построили социальную сеть для студентов Karpov Courses, которая обладает следующим функционалом: можно отправлять друг другу письма, создавать сообщества, аналогичные группам в известных сетях, и в этих сообществах публиковать посты.

Из приятного – при регистрации студенты должны заполнять данные по своему профилю, которые хранятся в поднятой на наших мощностях postgres database.

Так же наша платформа обладает лентой, которую пользователи могут листать и просматривать случайные записи случайных сообществ. Если пост нравится, можно поддержать автора и поставить like.

Все действия пользователей сохраняются, каждая их активность, связанная с просмотром постов, тоже записывается к нам в базу.

Платформа Karpov Courses заинтересована в благосостоянии студентов, поэтому разработчики решили усовершенствовать текущую ленту. А что, если показывать пользователям не случайные посты, а рекомендовать их точечно каждому пользователю из всего имеющегося множества написанных постов? Как это сделать и учесть индивидуальные характеристики профиля пользователя, его прошлую активность и содержимое самих постов?
В текущем домашнем задании вам предстоит построить рекомендательную систему постов в социальной сети. В качестве базовых сырых данных вы будете использовать подготовленные заранее командой курса таблицы.

С точки зрения разработки вам будет необходимо реализовать сервис, который будет для каждого юзера в любой момент времени возвращать посты, которые пользователю покажут в его ленте соцсети.
 
## Оценка качества модели
Качество написанного вами алгоритма будет проверяться в чекере по скрытому для вас ряду user_id и ряду timestаmp (эмулируем запросы пользователей в разное время) по метрике hitrate@5. 
![6A448BED-48D3-4161-98DD-A08310DEE249_1_201_a](https://github.com/kupeeved/karpov_courses/assets/144337372/2d8c95a3-c705-4614-ac2d-d930e6ea9f62)

## Что мы проверяем в решении проекта
На практике мы хотим достаточно быстро формировать рекомендации. Поэтому будем требовать, чтобы алгоритм работал не более, чем ~0.5 секунд на 1 запрос, и занимал не более ~4 гб памяти (цифры приблизительные).
Набор юзеров фиксирован и никаких новых появляться не будет
Чекер будет проверять модель в рамках того же временного периода, что вы видите в БД
Модели не обучаются заново при использовании сервисов. Мы ожидаем, что ваш код будет импортировать уже обученную модель и применять ее.

# 3 этап:  Рекомендательная система 2
В качестве возможных направлений для улучшения своей рекомендательной системы предлагаем вам рассмотреть:

Дополнительные признаки от нейронных сетей, например, векторизовать тексты постов с помощью разных методов, рассмотренных в блоке, сделать какие-то новые признаки на основе этих векторов.
Применить нейронные сети в качестве модели рекомендаций.

# 4 этап: A/B тест
Для AB теста на первом этапе мы научим наш сервис проводить A/B эксперимент, то есть разбивать пользователей на группы и для каждой из групп использовать одну из двух реализованных моделей (послабее из второго блока и более сильную из третьего).

Представим, что модель, которую вы сделали в 3-м блоке, будет тестовой, ![image](https://github.com/kupeeved/karpov_courses/assets/144337372/c63d328e-0fe2-41d9-9b94-09e271cc19d2)
  
  ![image](https://github.com/kupeeved/karpov_courses/assets/144337372/29c4df9f-1e3d-4b52-9d65-e63853772df5) 

и вы хотите её сравнить с моделью во 2-м блоке (она будет контрольной).

Технические особенности
Все требования к решению сохраняются. Ваш сервис должен продолжать строить рекомендации.

Внимание, в этом задании мы изменяем модель данных ответа нашего сервиса так, чтобы в ответ попадала группа, в которую попал пользователь, чтобы можно было увидеть по ответу endpoint-а и логам, что происходило. Неудобно, но почти как в жизни, приходится изменять то, о чём не подумали сразу. Теперь ваш сервис должен возвращать объект класса Response вместо List[PostGet].

1. Ваш сервис должен уметь применять одну из двух моделей для рекомендаций, более новую в качестве тестовой для проведения A/B эксперимента. Для этого он должен уметь разбивать пользователей на группы.

2. Сервис должен в своём ответе указывать, какую из моделей он применил, чтобы далее по логам можно было посчитать метрики для каждой из групп.



